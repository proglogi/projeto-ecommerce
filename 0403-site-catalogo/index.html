<!--PÃ¡gina principal (catÃ¡logo de produtos)-->

<!DOCTYPE html>
<html lang="pt-BR">

<head>
	<title>Home</title>

	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="keywords" content="">
	<meta name="author" content="Nicholly Gonzaga">

	<script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>

	<!-- Importando a fonte "Orbitron" do Google Fonts -->
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400..900&display=swap" rel="stylesheet">

	<link rel="stylesheet" type="text/css" href="stylesheet.css" media="screen" />

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body>
	<!-- CabeÃ§alho -->
	<header>
		<img src="IMG/logo-zumbits.png" width="150px" alt="Logo Zumbits">
		<h1><b>	Zumbits </b></h1><br>

	</header>

	<!-- Menu -->
	<div class="menu">
		<a href="#">Home</a>
		<a href="#">Produtos</a>
		<a href="#">Sobre</a>
		<a href="#">Contato</a>
	</div>

	<!-- ConteÃºdo do CatÃ¡logo -->
	<section id="catalogSection">
		<div id="productList" class="catalog"></div>
		<br>
	</section>

	<!-- Detalhamento do Produto (dentro da mesma pÃ¡gina) -->
	<section id="productDetailSection" style="display: none;">
		<div class="product-detail" id="productDetail">
			<p>Carregando detalhes...</p>
		</div>
	</section>

	<!-- RodapÃ© -->
	<footer>
		<p>Copyright Â© 2025 | Zumbits </p>
	</footer>

	<script>
		document.addEventListener("DOMContentLoaded", function () {
			console.log("PÃ¡gina carregada, iniciando Firebase...");
	
			// ConfiguraÃ§Ã£o do Firebase
			const firebaseConfig = {
				apiKey: "AIzaSyCjjy2B9jb2XZW4nIfMj1xDLogZc8oBd9M",
				authDomain: "estoque-naturale.firebaseapp.com",
				databaseURL: "https://estoque-naturale-default-rtdb.firebaseio.com",
				projectId: "estoque-naturale",
				storageBucket: "estoque-naturale.firebasestorage.app",
				messagingSenderId: "204707025194",
				appId: "1:204707025194:web:158dd6235e0996b6e54e53",
				measurementId: "G-ZJMVMSTSBJ"
			};
	
			// Inicializa o Firebase
			firebase.initializeApp(firebaseConfig);
	
			// ReferÃªncia ao nÃ³ 'produtos'
			const db = firebase.database().ref("produtos");
	
			// Executa mudanÃ§as em 'produtos'
			db.on("value", (snapshot) => {
				console.log("ðŸ”¥ Firebase snapshot bruto:", snapshot.val());

				const list = document.getElementById("productList");
				list.innerHTML = ""; // limpa os cards antes de renderizar novamente
	
				const dados = snapshot.val();
				console.log("Dados recebidos do Firebase:", dados);
	
				if (!dados) {
					list.innerHTML = "<p>Nenhum produto cadastrado.</p>";
					return;
				}
	
				Object.entries(dados).forEach(([id, produto]) => {
					const {
						descricao,
						precoVenda,
						precoCusto,
						categoria,
						marca,
						estoque,
						status,
						caracteristicas,
						fornecedor,
						dataCompra
					} = produto;
	
					const card = document.createElement("div");
					card.classList.add("product-card");
	
					card.innerHTML = `
						<a href="javascript:void(0);" onclick="loadProductDetail('${id}')">
							<img src="${produto.imagem}" alt="${descricao}" class="product-image">
							<h4>${descricao}</h4>
							<p>R$ ${precoVenda?.toFixed(2) ?? "0.00"}</p>
							<p>Marca: ${marca}</p>
							<p>Estoque: ${estoque ?? "-"}</p>
							<p>Status: ${status}</p>
						</a>
					`;
	
					list.appendChild(card);
					console.log("Imagem URL do produto:", produto.imagem);
				});
			});
		});

		// FunÃ§Ã£o para carregar os detalhes do produto
		function loadProductDetail (productId) {
			const catalogSection = document.getElementById("catalogSection");
			const productDetailSection = document.getElementById("productDetailSection");
			const productDetailDiv = document.getElementById ("productDetail");

			catalogSection.style.display = "none";
			productDetailSection.style.display = "block";

			firebase.database().ref(`produtos/${productId}`).get().then(snapshot => {
				const produto = snapshot.val();
				if (!produto) {
					catalogSection.innerHTML = "<p>Produto nÃ£o encontrado.</p>";
					return;
				}

				const {
					descricao,
					precoVenda,
					precoCusto,
					categoria,
					marca,
					estoque,
					status,
					caracteristicas,
					fornecedor,
					dataCompra,
					imagem // <--- pega a imagem aqui tambÃ©m
				} = produto;

				productDetailDiv.innerHTML = `
					<button class="back-button" onclick="goBack()">&#8592; Voltar</button>
					<div class="product-detail-container">
						<h2>${descricao}</h2>
						<div class="detail-content">
							<img src="${produto.imagem}" alt="${descricao}" class="product-detail-image">
					<div class="product-info">
							<div class="info-item"><i class="fas fa-tag"></i> <strong>Marca:</strong> ${marca}</div>
							<div class="info-item"><i class="fas fa-dollar-sign"></i> <strong>PreÃ§o de Venda:</strong> R$ ${precoVenda?.toFixed(2) ?? "0.00"}</div>
							<div class="info-item"><i class="fas fa-cogs"></i> <strong>Estoque:</strong> ${estoque ?? "-"}</div>
							<div class="info-item">
								<i class="fas fa-check-circle"></i> <strong>Status:</strong> 
								<span class="status ${status === 'em estoque' ? 'in-stock' : 'out-of-stock'}">${status}</span>
							</div>
							<div class="info-item"><i class="fas fa-info-circle"></i> <strong>CaracterÃ­sticas:</strong> ${caracteristicas}</div>
						</div>
					</div>
				`;

			});
		}

		function goBack() {
			document.getElementById("productDetailSection").style.display = "none";
			document.getElementById("catalogSection").style.display = "block";
		}

	</script>	
</body>
</html>
